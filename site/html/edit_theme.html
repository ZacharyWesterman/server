<h1>Theme Colors</h1>

<div class="card alt">
	<div class="card-inner">
		To reset colors to default values,<br>
		click the button below.<br>
		<button class="big wide border" onclick="reset_colors()">Reset Colors</button><br>
		<p class="error">Here's some example error text.</p>
		<p class="disabled">Here's some example disabled text.</p>
	</div>
</div>

<div class="card">
	<div class="card-inner">
		<h4>Text Colors</h4>
		<table>
			<tr>
				<td>Text on Background</td>
				<td><input id="--primary-text" type="color" onchange="update_colors(this)"></td>
			</tr>
			<tr>
				<td>Text on Default Content</td>
				<td><input id="--secondary-text" type="color" onchange="update_colors(this)"></td>
			</tr>
			<tr>
				<td>Text on Alternate Content</td>
				<td><input id="--tertiary-text" type="color" onchange="update_colors(this)"></td>
			</tr>
			<tr>
				<td>Error Text</td>
				<td><input id="--error-text" type="color" onchange="update_colors(this)"></td>
			</tr>
			<tr>
				<td>Disabled Text</td>
				<td><input id="--disabled-text" type="color" onchange="update_colors(this)"></td>
			</tr>
		</table>
		<p class="error">Here's some example error text.</p>
		<p class="disabled">Here's some example disabled text.</p>
	</div>
</div>

<div class="card">
	<div class="card-inner">
		<h4>Content Colors</h4>
		<table>
			<tr>
				<td>Primary Background</td>
				<td><input id="--primary" type="color" onchange="update_colors(this)"></td>
			</tr>
			<tr>
				<td>Secondary Background</td>
				<td><input id="--primary-alt" type="color" onchange="update_colors(this)"></td>
			</tr>
			<tr>
				<td>Default Content</td>
				<td><input id="--secondary" type="color" onchange="update_colors(this)"></td>
			</tr>
			<tr>
				<td>Alternate Content</td>
				<td><input id="--tertiary" type="color" onchange="update_colors(this)"></td>
			</tr>
		</table>
	</div>
</div>

<script>
	window.update_colors = field => {
		_.css.set_var(field.id, field.value)
		api.write_cookies()
		savecolors()
	}

	window.reset_colors = () => {
		for (var i of _.css.vars())
		{
			_.css.set_var(i, '')
		}
		setcolors()
		api.write_cookies()
		savecolors()
	}

	function setcolors()
	{
		for (var i of _.css.vars())
		{
			$(i).value = _.css.get_var(i)
		}
	}
	setcolors()

	function savecolors(wipe = false)
	{
		var colors = []
		for (var i of _.css.vars())
		{
			colors.push({name: i, value: _.css.get_var(i)})
		}

		api(`mutation ($username: String!, $theme: [ThemeColor!]!){
			updateUserTheme(username: $username, theme: $theme) {
				__typename
				...on UserDoesNotExistError {
					message
				}
			}
		}`, {username: api.username, theme: colors})
	}
</script>
