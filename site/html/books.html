<div class="card">
	<div class="card-inner">
		<div onclick="$.toggle_expand('card-create')">
			<h4>Add a New Book</h4>
		</div>

		<div class="expand-container">
			<div id="card-create" class="expand-contract">
				<table>
					<tr>
						<td>Tag ID</td>
						<td><input id="new-tagid" format="hex"></td>
					</tr>
					<tr>
						<td>Title</td>
						<td><input id="new-title"></td>
					</tr>
					<tr>
						<td>Author</td>
						<td><input id="new-author"></td>
					</tr>
					<tr>
						<td>Series</td>
						<td><input id="new-series"></td>
					</tr>
				</table>
			</div>
		</div>
	</div>
</div>

<script>
	//Start the NFC reader ONCE per session, and don't stop it.
	//Trying to stop/restart it multiple times in a session
	//just causes the browser to crash. :/
	if (window.NFC === undefined)
	{
		try {
			window.NFC = new NDEFReader
		} catch(e) {
			window.NFC = {
				scan: () => {}
			}
		}
	}

	NFC.onreading = event =>
	{
		$.toggle_expand('card-create', true)
		$('new-tagid').value = event.serialNumber
	}

	NFC.scan()

	window.unload.push(() => {
		NFC.onreading = undefined
	})
</script>
