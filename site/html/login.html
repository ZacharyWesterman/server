<!DOCTYPE html>
<html lang="en">
<head>
	<title>Authenticate</title>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<meta name="description" content="Authentication Page" />
	<script type="text/javascript" src="js/fields.js"></script>
	<script type="text/javascript" src="js/api.js"></script>
	<link rel="stylesheet" href="css/theme.css">
	<link rel="stylesheet" href="css/login.css">
</head>
<body>
	<div class="header">
		<h1>Authentication Required</h1>
	</div>

	<div class="body">
		<input id="username" placeholder="Username" />
		<br/>
		<input id="password" type="password" placeholder="Password" />
		<button type="button" onclick="login()">Login</button>
		<br/>
		<div id="errormsg" class="error"></div>
	</div>
</body>
<script type="text/javascript" defer>
	//Auto-login
	if (api.login_token !== null)
	{
		navigate('html/index.html')
	}

	function login(can_error = true)
	{
		api.authenticate($.val('username'), $.val('password')).then(success => {
			if (success)
			{
				api.write_cookies()
				navigate('/')
			}
			else if (can_error)
			{
				$('errormsg').innerText = 'Invalid Credentials'
			}
		})
	}
</script>
</html>
