{{~ it.books : book}}
<div class="card" style="max-width: 700px;">
	<div class="card-inner">
		<div class="actions right">
			<button class="icon clickable tooltip" *click="share_book('{{= book.shared ? book.shareHistory[book.shareHistory.length - 1].name : ''}}', '{{=safe_html(book.title)}}', '{{=safe_html(book.subtitle)}}', '{{=safe_html(book.authors.join(', '))}}', '{{=book.id}}', '{{=book.owner.username}}')">
				<i class="fa-solid fa-handshake fa-lg"></i>
				<span class="tooltiptext t-left">Sharing options</span>
			</button>
			{{? book.owner.username === api.username}}
			<button class="icon clickable tooltip" *click="edit_book('{{= book.rfid }}')">
				<i class="fa-solid fa-pen-to-square fa-lg"></i>
				<span class="tooltiptext t-left">Edit this book</span>
			</button>
			{{?}}
		</div>
		<span onclick="$.toggle_expand('card-{{=book.id}}')" class="clickable">
			<b>{{=book.title}}</b><br>
			{{?book.subtitle}}<i>{{=book.subtitle}}</i>{{?}}
			<div class="disabled">By {{=book.authors.join(', ')}}</div>
		</span>
		<table class="clickable" onclick="$.toggle_expand('card-{{=book.id}}')" style="padding-left:0;">
			<tr>
				{{?book.thumbnail}}<td><img src="{{=book.thumbnail}}" alt="<BOOK COVER>" loading="lazy"></td>{{?}}
				{{?book.categories.length}}
					<td style="width: 100%;">
						<blockquote style="valign: top;">
							<b><u>Categories</u></b>
							<div {{? environment.mobile || true }}class="marquee" style="height: {{= book.categories.length * 1.2 + 1 }}rem"{{?}}>
								<p>{{~ book.categories : genre}}{{= genre.replaceAll(' ', '&nbsp;')}}<br>{{~}}</p>
							</div>
						</blockquote>
					</td>
				{{?}}
			</tr>
		</table>
		<div class="expand-container clickable" id="card-{{=book.id}}" onclick="$.toggle_expand('card-{{=book.id}}')">
			<div>
				{{?book.description}}{{=book.description.replace('\n', '<br>')}}{{?}}
			</div>
		</div>
		<br>
		<div class="disabled">
			Owned by {{= book.owner.display_name }}{{? (book.owner.display_name.toLowerCase() !== book.owner.username.toLowerCase()) }} ({{= book.owner.username }}){{?}}
			{{?book.description}}<div class="actions right">
				<button class="icon clickable tooltip" onclick="$.toggle_expand('card-{{=book.id}}')">
					<i class="fa-solid fa-angles-down fa-lg"></i>
					<span class="tooltiptext t-left">Show/hide description</span>
				</button>
			</div>{{?}}
		</div>
		{{? book.shared }}
		<i class="error">
			Borrowed by {{= book.shareHistory[book.shareHistory.length - 1].display_name }}{{? (book.shareHistory[book.shareHistory.length - 1].display_name.toLowerCase() !== book.shareHistory[book.shareHistory.length - 1].name.toLowerCase()) }} ({{= book.shareHistory[book.shareHistory.length - 1].name }}){{?}}{{? book.shareHistory[book.shareHistory.length - 1].user_id === null }}
			<span class="tooltip">
				<i class="fa-solid fa-user-slash fa-sm"></i>
				<span class="tooltiptext t-center t-persist">Not a user</span>
			</span>{{?}}
		</i>{{?}}

		<div class="disabled">
			ISBN: {{=book.industryIdentifiers[0]?.identifier}}
		</div>
	</div>
</div>
{{~}}
