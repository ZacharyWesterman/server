{{~ it.books : book}}
<div class="card" style="max-width: 700px;">
	<div class="card-inner">
		<div class="actions right">
			{{? book.owner === api.username}}<button class="icon clickable" *click="confirm_unlink_book('{{=safe_html(book.title)}}', '{{=book.rfid}}')"><i class="fa-solid fa-trash fa-lg disabled"></i></button><br>{{?}}
			<button class="icon clickable" *click="share_book('{{= book.shared ? book.shareHistory[book.shareHistory.length - 1].name : ''}}', '{{=safe_html(book.title)}}', '{{=safe_html(book.subtitle)}}', '{{=safe_html(book.authors.join(', '))}}', '{{=book.id}}', '{{=book.owner.username}}')"><i class="fa-solid fa-handshake fa-lg"></i></button><br>
			{{?book.description || (environment.mobile && book.categories.length)}}<button class="icon clickable" onclick="$.toggle_expand('card-{{=book.id}}')"><i class="fa-solid fa-angles-down fa-lg"></i></button>{{?}}
		</div>
		<span onclick="$.toggle_expand('card-{{=book.id}}')" class="clickable">
			<b>{{=book.title}}</b><br>
			{{?book.subtitle}}<i>{{=book.subtitle}}</i>{{?}}
			<div class="disabled">By {{=book.authors.join(', ')}}</div>
		</span>
		<table class="clickable" onclick="$.toggle_expand('card-{{=book.id}}')">
			<tr>
				{{?book.thumbnail}}<td><img src="{{=book.thumbnail}}" alt="<BOOK COVER>" loading="lazy"></td>{{?}}
				{{?book.categories.length && !environment.mobile}}
					<td><blockquote style="valign: top;">
						<b><u>Categories</u></b>
						{{~ book.categories : genre}}<br>{{=genre}}{{~}}
					</blockquote></td>
				{{?}}
			</tr>
		</table>
		<div class="expand-container clickable" id="card-{{=book.id}}" onclick="$.toggle_expand('card-{{=book.id}}')">
			<div>
				{{?book.categories.length && environment.mobile}}
					<blockquote style="valign: top;">
						<b><u>Categories</u></b>
						{{~ book.categories : genre}}<br>{{=genre}}{{~}}
					</blockquote>
				{{?}}
				{{?book.description}}{{=book.description.replace('\n', '<br>')}}{{?}}
			</div>
		</div>
		<br><div class="disabled">Physical copy owned by {{= book.owner.display_name }}{{? (book.owner.display_name.toLowerCase() !== book.owner.username.toLowerCase()) }} ({{= book.owner.username }}){{?}}</div>
		{{? book.shared }}<i class="error">Currently being borrowed by {{= book.shareHistory[book.shareHistory.length - 1].display_name }}{{? (book.shareHistory[book.shareHistory.length - 1].display_name.toLowerCase() !== book.shareHistory[book.shareHistory.length - 1].name.toLowerCase()) }} ({{= book.shareHistory[book.shareHistory.length - 1].name }}){{?}}{{? book.shareHistory[book.shareHistory.length - 1].user_id === null }}&nbsp;<i class="fa-solid fa-user-slash fa-sm"></i>{{?}}</i>{{?}}
	</div>
</div>
{{~}}
